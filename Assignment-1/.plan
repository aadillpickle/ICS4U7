TODO: 
- fix function F
- documentation (use javadoc)